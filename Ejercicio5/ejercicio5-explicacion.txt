Dado que las cortinas pueden estar en dos estados, podemos interpretarlas como bits para facilitar los cálculos. Podemos contabilizar solo los casos favorables dejando inicialmente fijo a la izquierda, un bloque de tres bits en 111 (nuestras 3 ventanas con cortinas) con lo cual notaremos que la cantidad de combinaciones del resto de los bits será igual a 2^(n-3). Luego correremos nuestro bloque de 3 bits hacia la derecha y tendremos también una cantidad de combinaciones igual a 2^(n-3), con la salvedad de que la segunda mitad de nuestras combinaciones coincidirá con la segunda mitad del caso anterior. Luego, si es que podemos, correremos nuevamente hacia la derecha nuestros 3 bit 111 y notaremos que ahora se repite el 2do y el 4to cuarto de las combinaciones. Esto no es ningún misterio y se podría comprender mejor el “efecto” colocando el bloque de 3 bits 111 a la derecha y corriéndolo hacia la izquierda. Dado que nuestro bloque podrá correrse hacia la derecha un total de n-3 veces, podemos decir que a la cantidad inicial de combinaciones 2^(n-3) se le sumarán 2^(n-3)/2 por la cantidad de veces que podamos correr el bloque 111, es decir n-3 veces. Expresado matemáticamente quedaría de la siguiente forma

combinaciones = 2^(n-3) + (n-3) * 2^(n-3)/2  
lo cual, tras sacar el factor común 2^(n-3), puede reducirse a
2^(n-3) * (1+(n-3)/2)